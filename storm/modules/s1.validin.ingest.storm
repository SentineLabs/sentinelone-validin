function get_source() {
    // lift the meta:source or add it if it doesn't exist

    $name = "validin api"
    [meta:source=($name,) :name=$name]
    return($node)
}

function set_seen_ival(inode, record) {
    // set the .seen property for a record

    $first = ($record.first_seen * 1000)
    $last = ($record.last_seen * 1000)

    yield $inode [.seen=($first, $last)]
    return()
}